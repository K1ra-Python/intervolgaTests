<?php

//Очень странный начальный массив с масивами 
$data = [
  ['Иванов', 'Математика', 5],
  ['Иванов', 'Математика', 4],
  ['Иванов', 'Математика', 5],
  ['Петров', 'Математика', 5],
  ['Сидоров', 'Физика', 4],
  ['Иванов', 'Физика', 4],
  ['Петров', 'ОБЖ', 4],
];

// Создаём пустой массив где будет храниться группировка
$groupedData = [];
//Начинаем цикл foreach чтобы пройтись по каждому массиву в $data
foreach ($data as $item) {
    //Присваиваем трём следующим переменным значения из $item(Имя студента, предмет и оценка)
    $student = $item[0];
    $subject = $item[1];
    $grade = $item[2];
    //Создаём проверку, есть ли уже ученик в groupedDate
    if (!isset($groupedData[$student][$subject])) {
        //Если нет, то создаём запись где изначальная оценка будет 0. ТО есть каждая запись начинает с оценкой 0
        $groupedData[$student][$subject] = 0;
    }
    //К существующей оценке добавляем оценку из $data
    $groupedData[$student][$subject] += $grade;
}



// Выводим таблицу
echo "<table>";
echo "<tr><th></th>";

// Выводим заголовки столбцов (предметы)
$subjects = array_unique(array_column($data, 1));// Получаем уникальные значения предметом чтобы избежать дубликатов
sort($subjects);//Сортируем для удобства в алфавитном порядке
foreach ($subjects as $subject) {
    echo "<th>$subject</th>";//Вывод foreach заголовка в качестве предмета
}
echo "</tr>";

// Выводим строки таблицы (ученики)
foreach ($groupedData as $student => $grades) {
    echo "<tr><td>$student</td>";// Выводим строку таблицы с именем ученика
    foreach ($subjects as $subject) {
        echo "<td>" . ($grades[$subject] ?? '') . "</td>";// Выводим оценку для каждого предмета (или пустую ячейку, если нет оценки)
    }
    echo "</tr>";
}

echo "</table>";
